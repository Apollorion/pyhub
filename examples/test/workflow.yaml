concurrency:
  group: main
env:
  A: 'false'
  TEST: test
jobs:
  test1:
    env:
      this: isgood
    needs:
    - test2
    outputs: {}
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
      with:
        ref: main
    - uses: actions/install-python
      with:
        test: 'yes'
    - name: Install Requirements
      run: python -m pip install requirements.txt
    - id: run
      name: test1
      run: |
        python <<EOF
        def set_output(output_name: str, value: str):
            print(f"::set-output name={output_name}::{value}")

        def test1(output_from_test_2):
            print(output_from_test_2)


        test1("${{ needs.test2.outputs.test_output }}")
        EOF
  test2:
    if: github.ref_name == 'main'
    needs: []
    outputs:
      test_output: ${{ steps.run.outputs.test_output }}
    runs-on: custom-runner
    steps:
    - name: Install Requirements
      run: python -m pip install requirements.txt
    - id: run
      name: test2
      run: |
        python <<EOF
        def set_output(output_name: str, value: str):
            print(f"::set-output name={output_name}::{value}")

        def test2():
            set_output("test_output", "test2 returned")


        test2()
        EOF
name: My Amazing Test Workflow
'on':
  push: {}
permissions:
- write-all
